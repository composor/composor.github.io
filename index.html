<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Composi</title>
  <link rel="stylesheet" href="./css/prism-tomorrow.css">
  <link rel="stylesheet" href="./css/styles.css">
</head>
<body>
  <nav>
    <ul class='nav--menu'>
      <li class='nav--menu__item'>
        <a class='nav--menu__item__link' href="./index.html">
          <svg id='composi-logo' viewBox="0 0 300 300" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <title>Composi Logo</title>
            <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
              <g id="Composi-Logo-Solid" fill="#fff">
                <path d="M1.77635684e-15,0 L95,0 L95,38 L209,38 L209,0 L300,0 L300,94 L265,93.8571663 L265,209 L300,209 L300,300 L209,300 L209,265 L95,265 L95,300 L1.77635684e-15,300 L1.77635684e-15,209 L40,209 L40,94 L1.77635684e-15,93.8571663 L1.77635684e-15,0 Z M107,107 L107,192 L192,192 L192,107 L107,107 Z" id="Combined-Shape"></path>
              </g>
            </g>
          </svg>
        <span class='logo__link--text'>Composi</span></a>
      </li>
      <li class='nav--menu__item'>
        <a class='nav--menu__item__link' href="./docs/installation.html">Docs</a>
      </li>
      <li class='nav--menu__item'>
        <a class='nav--menu__item__link' href="./tuts/index.html">Tutorials</a>
      </li>
    </ul>
  </nav>
  <header class='main__header'>
    <section>
      <h1>Composi</h1>
      <h2>Make Component-Based Interfaces</h2>
    </section> 
  </header>
  <article>
    <section>
      <div class="main__column">
        <h2 class='main__modular'>Modular</h2>
        <p>Create simple components and combine them into more complex ones. The virtual dom takes care of efficiently updating the HTML when a component's state changes.</p>
        <p>Components make it easy to build and organize complex applications, while keeping the code clean and readable.</p>
      </div>
      <div class="main__column">
        <h2 class='main__declarative'>Declarative</h2>
        <p>Define your component markup with JSX, or Hyperscript, or ES6 template literals. </p>
        <p>Everything is just JavaScript. You can use JavaScript expressions inside your component code.</p>
        <p>No need for special markup syntax for templates. Use standard JavaScript for everything.</p>
      </div>
      <div class="main__column">
        <h2 class='main__reusable'>Reusable</h2>
        <p>Because components encapsulate their behavior and properties, you can reuse them throughout your application, and even in other applications.</p>
        <p>Render default HTML on the server and bring everything to life at load time with Composi. Use whatever backend you want.</p>
      </div>
    </section>
    <section class='main__section__separator'>
        <hr class='main__separator'>
    </section>
    <section class='main__example--section'>
      <div class="main__example--column">
        <h3>A Simple Component</h2>
        <p>Componets use a render function. This takes data and returns the HTML to create. The <code>render</code> function expects a name to render. We pass that to the component through its <code>update</code> method.</p>
        <p>Update with a name trigger's the virtual dom, which then patches the document.</p>
      </div>
      <div class='main__editor--example'>
        <pre>
          <code class="language-jsx">
class HelloMessage extends Component {
  render(name) {
    return (
      &lt;div>
        Hello, {name}!
      &lt;/div>
    )
  }
}
// Instantiate the component:
const helloMsg = new HelloMessage()

// Define container in which to render the component:
helloMsg.container = '#hello-world'

// Pass the instance some data to render it:
helloMsg.update('Joe')
          </code>
        </pre>
      </div>
      <div class='main__editor--result'>
        <h4 class='main__example__result--title'>Result</h4>
        <aside id='hello-world' class='main__example__output'></aside>
      </div>
    </section>
    <section>
      <div class="main__example--column">
        <h3>A Stateful Component</h2>
        <p>Beside passing data to a component through its <code>update</code> method, we can make a component stateful. When we do this, whenever the component's state changes, the component will automatically invoke its <code>update</code> method with the new data.</p>
        <p>We've put a guard in the <code>tick</code> method to stop after 30 seconds. We use the lifecycle method <code>componentWasCreated</code> to start the <code>tick</code> method.</p>
      </div>
      <div class='main__editor--example'>
        <pre>
          <code class="language-jsx">
class Timer extends Component {
  constructor(props) {
    super(props)
    this.container = 'body'
    this.state = { seconds: 0 }
  }

  tick() {
    // Stop after 30 ticks:
    if (this.state.seconds === 30) {
      clearInterval(this.interval)
    }
    this.setState((prevState) => ({
      seconds: prevState.seconds + 1
    }))
  }

  componentWasCreated() {
    this.interval = setInterval(() => this.tick(), 1000)
  }

  componentWillUnmount() {
    clearInterval(this.interval)
  }

  render() {
    return (
      &lt;div>
        Seconds: {this.state.seconds}
      &lt;/div>
    );
  }
}

// Instantiate the timer to start it.
// Since it has state, it will render automatically.
const timer = new Timer()
          </code>
        </pre>
      </div>
      <div class='main__editor--result'>
        <h4 class='main__example__result--title'>Result</h4>
        <aside class='main__example__output' id='timer'>
          
        </aside>
      </div>
    </section>
    <section>
      <div class="main__example--column">
        <h3>An Application</h2>
        <p>Here we put together a simple Todo list. We give the component state and pass down that state to child component as props in curly braces.</p>
        <p>For events we use the <code>handleEvent</code> interface and a lifecycle method, <code>componentWasCreated</code> to wire up some event listeners. We want to listen for changes to the text input and to the button click for submission.</p> 
      </div>
      <div class='main__editor--example'>
        <pre>
          <code class="language-jsx">
class TodoApp extends Component {
  constructor(props) {
    super(props);
    this.container = 'section'
    this.state = { items: [], text: '' };
  }

  render(state) {
    return (
      &lt;div>
        &lt;h3>TODO</h3>
        &lt;TodoList {...{state}} />
        &lt;form>
          &lt;input value={state.text} />
          &lt;button>
            Add #{state.items.length + 1}
          &lt;/button>
        &lt;/form>
      &lt;/div>
    );
  }

  componentWasCreated() {
    this.element.addEventListener('click', this)
    this.element.addEventListener('change', this)
  }
  handleEvent(e) {
    e.target.id === 'add-item' && this.handleSubmit(e)
    e.target.id === 'input__add-item' && this.handleChange(e)
  }

  handleChange(e) {
    this.setState({ text: e.target.value });
  }

  handleSubmit(e) {
    e.preventDefault();
    if (!this.state.text.length) {
      return;
    }
    const newItem = {
      text: this.state.text,
      id: Date.now()
    };
    this.setState((prevState) => ({
      items: prevState.items.concat(newItem),
      text: ''
    }));
  }
}

function TodoList({state}) {
  return (
  &lt;ul>
    {
      state.items.map(item => <li key={item.id}>{item.text}</li>)
    }
  &lt;/ul>
  );
}

// Instantiate the todo list.
// Since it has state, it will render automatically.
const app = new TodoApp()
          </code>
        </pre>
      </div>
      <div class='main__editor--result'>
        <h4 class='main__example__result--title'>Result</h4>
        <aside class='main__example__output' id='todo-list'></aside>
      </div>
    </section>
  </article>
  <footer>
    <section>
      <svg id='composi-logo-footer' viewBox="0 0 300 300" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
        <title>Composi Logo</title>
        <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
          <g id="Composi-Logo-Solid" fill="rgba(255,255,255,0.5)">
            <path d="M1.77635684e-15,0 L95,0 L95,38 L209,38 L209,0 L300,0 L300,94 L265,93.8571663 L265,209 L300,209 L300,300 L209,300 L209,265 L95,265 L95,300 L1.77635684e-15,300 L1.77635684e-15,209 L40,209 L40,94 L1.77635684e-15,93.8571663 L1.77635684e-15,0 Z M107,107 L107,192 L192,192 L192,107 L107,107 Z" id="Combined-Shape"></path>
          </g>
        </g>
      </svg>
      <h3>Composi is open source (MIT) and available on <a href='https://github.com/composor/composi' target='__blank'>Github</a> and <a href="https://www.npmjs.com/package/composi" target='__blank'>NPM</a>.</h3>
    </section>
  </footer>

  <script src="./js/prism.min.js"></script>
  <script src="./js/prism-jsx.js"></script>
  <script src="./js/composi.js"></script>
  <script>
    var h = composi.h
    var Component = composi.Component

    // Hello World:
    class HelloMessage extends Component {
    
      render(name) {
        return h('div', {}, `Hello, ${name}!`)
      }
    }
    const helloMsg = new HelloMessage()
    helloMsg.container = '#hello-world'
    helloMsg.update('Joe')

    // Timer:
    class Timer extends Component {
    constructor(props) {
      super(props);
      this.container = '#timer'
      this.state = { seconds: 0 };
    }

    tick() {
      if (this.state.seconds === 29) clearInterval(this.interval)
      this.setState((prevState) => ({
        seconds: prevState.seconds + 1
      }));
    }

    componentWasCreated() {
      this.interval = setInterval(() => this.tick(), 1000);
    }

    componentWillUnmount() {
      clearInterval(this.interval);
    }

    render() {
      return h('div', {}, `Seconds: ${this.state.seconds}`)
    }
  }

  const timer = new Timer()


    // Todo List:
    class TodoApp extends Component {
      constructor(props) {
        super(props);
        this.container = '#todo-list'
        this.state = { items: [], text: '' };
      }

      render(state) {
        return h(
          "div",
          null,
          h(
            "h3",
            null,
            "TODO"
          ),
          h(TodoList, { state: state }),
          h(
            "form",
            null,
            h("input", {
              id: "input__add-item",
              value: state.text
            }),
            h(
              "button",
              { id: "add-item" },
              "Add #",
              state.items.length + 1
            )
          )
        )
      }

      handleEvent(e) {
        e.target.id === 'add-item' && this.handleSubmit(e)
        e.target.id === 'input__add-item' && this.handleChange(e)
      }

      componentWasCreated() {
        this.element.addEventListener('click', this)
        this.element.addEventListener('change', this)
      }

      handleChange(e) {
        this.setState({ text: e.target.value })
      }

      handleSubmit(e) {
        e.preventDefault();
        if (!this.state.text.length) {
          return
        }
        const newItem = {
          text: this.state.text,
          id: Date.now()
        };
        this.setState((prevState) => ({
          items: prevState.items.concat(newItem),
          text: ''
        }));
      }
    }

    function TodoList({state}) {
      return h(
        "ul",
        null,
        state.items.map(function (item) {
          return h(
            "li",
            { key: item.id },
            item.text
          )
        })
      )
    }

    const app = new TodoApp()
  </script>
</body>
</html>