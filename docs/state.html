<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="description" content="Composi is a JavaScript library for creating component-based interfaces. It uses the virtual dom to make efficient updates to the DOM based on a component's data or state.">
  <meta name="keywords" content="javascript, framework, performance, small, fast, UI, programming, code, component, composi, chocolatechipui, chocolatechip-ui, reactive, virtual dom">
  <title>Composi - Docs</title>
  <link rel="stylesheet" href="../css/styles.css">
  <link rel="stylesheet" href="../css/styles.css">
  <link rel="stylesheet" href="../css/prism-tomorrow.css">
</head>
<body class='documentation-page'>
  <nav>
    <ul class='nav--menu'>
      <li class='nav--menu__item'>
        <a class='nav--menu__item__link' href="../index.html">
          <svg id='composi-logo' viewBox="0 0 300 300" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <title>Composi Logo</title>
            <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
              <g id="Composi-Logo-Solid" fill="#fff">
                <path d="M1.77635684e-15,0 L95,0 L95,38 L209,38 L209,0 L300,0 L300,94 L265,93.8571663 L265,209 L300,209 L300,300 L209,300 L209,265 L95,265 L95,300 L1.77635684e-15,300 L1.77635684e-15,209 L40,209 L40,94 L1.77635684e-15,93.8571663 L1.77635684e-15,0 Z M107,107 L107,192 L192,192 L192,107 L107,107 Z" id="Combined-Shape"></path>
              </g>
            </g>
          </svg>
        <span class='logo__link--text'>Composi</span></a>
      </li>
      <li class='nav--menu__item selected'>
        <a class='nav--menu__item__link' href="./installation.html">Docs</a>
      </li>
      <li class='nav--menu__item'>
        <a class='nav--menu__item__link' href="../tuts/index.html">Tutorials</a>
      </li>
      <li class='nav--menu__item'>
        <a class='nav--menu__item__link external' target='__blank' href="https://github.com/composor/awesome-composi">Resources
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="14px" height="14px" viewBox="0 0 511.626 511.627" style="enable-background:new 0 0 511.626 511.627;"
	 xml:space="preserve">
  <path fill='#fff' d="M392.857,292.354h-18.274c-2.669,0-4.859,0.855-6.563,2.573c-1.718,1.708-2.573,3.897-2.573,6.563v91.361
    c0,12.563-4.47,23.315-13.415,32.262c-8.945,8.945-19.701,13.414-32.264,13.414H82.224c-12.562,0-23.317-4.469-32.264-13.414
    c-8.945-8.946-13.417-19.698-13.417-32.262V155.31c0-12.562,4.471-23.313,13.417-32.259c8.947-8.947,19.702-13.418,32.264-13.418
    h200.994c2.669,0,4.859-0.859,6.57-2.57c1.711-1.713,2.566-3.9,2.566-6.567V82.221c0-2.662-0.855-4.853-2.566-6.563
    c-1.711-1.713-3.901-2.568-6.57-2.568H82.224c-22.648,0-42.016,8.042-58.102,24.125C8.042,113.297,0,132.665,0,155.313v237.542
    c0,22.647,8.042,42.018,24.123,58.095c16.086,16.084,35.454,24.13,58.102,24.13h237.543c22.647,0,42.017-8.046,58.101-24.13
    c16.085-16.077,24.127-35.447,24.127-58.095v-91.358c0-2.669-0.856-4.859-2.574-6.57
    C397.709,293.209,395.519,292.354,392.857,292.354z"/>
  <path fill='#fff' d="M506.199,41.971c-3.617-3.617-7.905-5.424-12.85-5.424H347.171c-4.948,0-9.233,1.807-12.847,5.424
    c-3.617,3.615-5.428,7.898-5.428,12.847s1.811,9.233,5.428,12.85l50.247,50.248L198.424,304.067
    c-1.906,1.903-2.856,4.093-2.856,6.563c0,2.479,0.953,4.668,2.856,6.571l32.548,32.544c1.903,1.903,4.093,2.852,6.567,2.852
    s4.665-0.948,6.567-2.852l186.148-186.148l50.251,50.248c3.614,3.617,7.898,5.426,12.847,5.426s9.233-1.809,12.851-5.426
    c3.617-3.616,5.424-7.898,5.424-12.847V54.818C511.626,49.866,509.813,45.586,506.199,41.971z"/>
</svg></a>
      </li>
    </ul>
  </nav>
  <article class='docs__article'>
    <section>
      <div class='docs'>
          <h1>State</h1>
          <p class="docs__intro">Components can be stateless or stateful. There are advantages to both. Chose the right one depending on use case. For example, if a component will only display the result of some other action, make it stateless and pass it the data it needs. If the data of a component can change at unpredictable times, make it stateful. That way, when its data changes, it will update automatically. If you have a fixed dataset and the component will never need to be rendered again during the session, make it stateless and pass it the data.</p>

          <p>When you give a component state, Composi assigns the state getters and setters. Setting state causes the component to render a new virtual dom, diff it with the old virtual dom, and if there are differences, update the actual DOM. As such, the assignment of data to a component's state will trigger an update. Setting state directly is ideal for primitive data types, such as string, numbers:</p>

          <p data-height="300" data-theme-id="6688" data-slug-hash="VrYLLv" data-default-tab="js,result" data-user="rbiggs" data-embed-version="2" data-pen-title="Composi state-1" class="codepen">See the Pen <a href="https://codepen.io/rbiggs/pen/VrYLLv/">Composi state-1</a> by Robert Biggs (<a href="https://codepen.io/rbiggs">@rbiggs</a>) on <a href="https://codepen.io">CodePen</a>.</p>
<script async src="https://production-assets.codepen.io/assets/embed/ei.js"></script>
          <p>Or we can add state in the component's constructor when extending the Component class:</p>

          <p data-height="300" data-theme-id="6688" data-slug-hash="MOYwwq" data-default-tab="js,result" data-user="rbiggs" data-embed-version="2" data-pen-title="Composi state-2" class="codepen">See the Pen <a href="https://codepen.io/rbiggs/pen/MOYwwq/">Composi state-2</a> by Robert Biggs (<a href="https://codepen.io/rbiggs">@rbiggs</a>) on <a href="https://codepen.io">CodePen</a>.</p>
<script async src="https://production-assets.codepen.io/assets/embed/ei.js"></script>
          <p>Or you could add state when you initialize a new component:</p>
          <p data-height="300" data-theme-id="6688" data-slug-hash="mqyJeO" data-default-tab="js,result" data-user="rbiggs" data-embed-version="2" data-pen-title="Composi state-3" class="codepen">See the Pen <a href="https://codepen.io/rbiggs/pen/mqyJeO/">Composi state-3</a> by Robert Biggs (<a href="https://codepen.io/rbiggs">@rbiggs</a>) on <a href="https://codepen.io">CodePen</a>.</p>
<script async src="https://production-assets.codepen.io/assets/embed/ei.js"></script>
          <p> </p>

          <h2>How State Gets Passed</h2>
          <p>When you give a component state, at render time the value of state gets passed to the <code>render</code> function as its data. No need to directly reference state inside the <code>render</code> function. So, in the above example, the value of the <code>render</code> parameter <code>message</code> will be the value of the component's state property.</p>

          <p>In the case were no state is provided, the <code>render</code> function's parameter will reference any data pass to the component's <code>update</code> function.</p>

          <h2>Strings and Numbers as State</h2>
          <p>In our previous example we used as string as the component's state. You could also use a number. In that case you could perform Math operations with the value of the state and then reassign it back to the state to update the component.</p>
          
          <h2>Booleans</h2>
          <p>By default boolean values are not output. This is so they can be used for conditional checks. However, if you want to output a boolean value, just convert it to a string. There are two ways to do this. For <code>true</code> or <code>false</code> you can add <code>toString()</code> to convert them to strings. The values <code>null</code> and <code>undefined</code> do not have a <code>toString()</code> function, but you can use string concatenation to convert them, or use <code>String(value)</code>. Below are examples of these approaches. Note, we are just showing the render function, not the complete component code:</p>

          <pre>
            <code class="language-javascript">
// For true or false:
render: (value) => &lt;p>The boolean value is: {value.toString()}&lt;/p>

// The above approach would throw an error if the boolean was undefined or null.
// For them, do the following:
render: (value) => &lt;p>The boolean value is: {value + ''}&lt;/p>

// Make boolean uppercase:
render: (value) => &lt;p>The boolean value is: {(String(value).toUpperCase()}&lt;/p></code>
          </pre>

              <p> </p>
              <h2>setState</h2>
              <p>Most components will have state of complex data types: objects or arrays. To update the state of complex types you have two choices: use the <code>setState</code> method or get the state, perform your operations and set the state with the final result. We'll look at <code>setState</code> first.</p>

              <h2>Setting State for Primitive Types</h2>
              <p>When the type is primitive, a string, number or boolean, you can set the state directly, or use the <code>setState</code> method:</p>
              <pre>
                <code class="language-javascript">
helloWorld.state = 'everybody'

// or:
helloWorld.setState('everybody')</code>
              </pre>
              <p>Please note that although you can set state by assigning the data to the component's <code>state</code> property, it's always preferable and safer to use <code>setState</code> to do so.</p>

              <p> </p>
              <h2>Setting State for Complex Types - setState</h2>
              <p>The purpose of <code>setState</code> is to enable making a patch to state that is an object or array. Because state is controlled by its getters and setters, you cannot directly manipulate the data it contains. With component state you can either get it, or set it.</p>
              <p>First lets look at a component that prints out a person object:</p>
              
              <p data-height="400" data-theme-id="6688" data-slug-hash="qVEdNE" data-default-tab="js,result" data-user="rbiggs" data-embed-version="2" data-pen-title="Composi state-4" class="codepen">See the Pen <a href="https://codepen.io/rbiggs/pen/qVEdNE/">Composi state-4</a> by Robert Biggs (<a href="https://codepen.io/rbiggs">@rbiggs</a>) on <a href="https://codepen.io">CodePen</a>.</p>
<script async src="https://production-assets.codepen.io/assets/embed/ei.js"></script>
              <p>Now imagine you want to update the the person's job. You might think you could access the job directingly on the state object, but you can't. That would be an assignment, and because state has a setter, you can only assign to the state itself:</p>
              <pre>
                <code class="language-javascript">
// This assignment will not work:
personComponent.state.job = 'Web Developer'</code>
              </pre>
              <p>Instead of trying to assign a property of the state object, we need to use the <code>setState</code> method. To update a state object property, we pass in an object with that property and the new value. Behind the scenes, <code>setState</code> will mixin the new object with the state object. Then it will create a new virtual dom and patch the actual DOM to reflect those changes:</p>
              <pre>
                <code class="language-javascript">
// Update the job property of the component's state:
personComponent.setState({job: 'Web Developer'})</code>
              </pre>

              <p> </p>
              <h2>Updating Array State</h2>
              <p>When a component has an array as state, you need to provide a second argument for <code>setState</code>: the index of the array where you want to make the index. For instance, suppose we have a component <code>fruitList</code> that prints out a list of fruits. We notice that the third item in the list is mispelled and want to update it. We can do that as follows:</p>
              <pre>
                <code class="language-javascript">
fruitList.state = ['Apples', 'Oranges', 'Pinpalpes', 'Bananas']

// Use second argument for index in the array you want to update:
fruitList.setState('Pinapples', 2)</code>
</pre>
                <p> </p>
                <h2>Updating state for Array of Objects</h2>
                <p>Suppose a component's state is an array of objects:</p>
                <pre>
                  <code class="language-javascript">
const people = [
  {
    firstName: 'Joe',
    lastName: 'Bodoni',
    job: 'Mechanic'
  },
  {
    firstName: 'Ellen',
    lastName: 'Vanderbilt',
    job: 'Lab Technician'
  },
  {
    firstName: 'Sam',
    lastName: 'Anderson',
    job: 'Web Developer'
  }
]</code>
</pre>
            <p>This array is used as the state for a component of users. We want to update Joe's job to Rock Star. You might try to do this:</p>
            <pre>
              <code class="language-javascript">
// Update job for Joe Bodoni:
userList.setState({job: 'Rock Star'}, 0)</code>
            </pre>
            <p>Doing the above will actually replace whatever is currently at index 0 with the new object with just the job property. That's because when you use <code>setState</code> on an array with an index value, Composi uses that information to splice the array. As such it is not possible to update an array of objects with <code>setState</code>. To do so you will need to get the state, perform whatever transform you need and then re-assign the state with the new array:</p>
            <pre>
              <code class="language-javascript">
// Proper way to update an object in an array.
// Get the Joe Bodoni user from state:
const newState = userList.state[0]

// Set job to new value:
newState.job = 'Rock Star'

// Update component's state:
userList.setState(newState)</code>
</pre>
              <p> </p>
              <h2>Complex State Operations</h2>
              <p>As we saw in our last example of arrays, sometimes you will need to get the state, operate on it separately and then set the component's state to that. For example, if you need to use map, filter, sort or reverse on an array, you'll want to get the complete state and perform these operations. Aftwards you can just set the state:</p>
              <pre>
                <code class="language-javascript">
// Get the component's state:
const newState = fruitsList.state

// Reverse the array:
newState.reverse()

// Set the component's state with the new state:
fruitsList.setState(newState)</code>
              </pre>
              <p> </p>
              <h2>setState with a Callback</h2>
              <p>One option for handling the need for complex operations when setting state is to pass a callback to the <code>setState</code> method. When you do so, the first argument of the callback will be the component's state. In the example below, we get the state and manipulate it in the <code>handleClick</code> method. After doing what you need to with state, remember to return it. Otherwise the component's state will not get updated.</p>
              <p>Notice how we use a callback in the <code>setState</code> method inside the <code>handleClick</code> method to test what the current value of state is:</p>

              <p>Codepen Example:</p>
              <p data-height="550" data-theme-id="6688" data-slug-hash="XzJbjQ" data-default-tab="js,result" data-user="rbiggs" data-embed-version="2" data-pen-title="Composi state-5" class="codepen">See the Pen <a href="https://codepen.io/rbiggs/pen/XzJbjQ/">Composi state-5</a> by Robert Biggs (<a href="https://codepen.io/rbiggs">@rbiggs</a>) on <a href="https://codepen.io">CodePen</a>.</p>
<script async src="https://production-assets.codepen.io/assets/embed/ei.js"></script>
              <p>Be aware that whatever the callback returns will be set as the component's new state. Therefore you will need to make all changes to the component's whole state before returning it.</p>

                        <h2>componentShouldUpdate</h2>
          <p>Sometimes you need to do some complex operations on data and you don't want the component to update constantly due to changes. Or you want to render a component with some external DOM plugin, possibly jQuery. For these situations you can use the <code>comonentShouldUpdate</code> property inside the class constructor. By default it is set to true. Setting it to false causes a component to render only once. Even though the <code>update</code> function is invoked on it, or its state changes, it will not update.</p>
          <p>You can make the component react to updates again by setting this property back to true on the component instance. However, if you changed state before setting <code>comonentShouldUpdate</code> back to <code>true</code> and want the component to then update, you will need to do so by invoking the <code>update()</code> function on the component instance. This will use the current state.</p>

          <pre>
            <code class="language-javascript">
class Hello extends Component {
  constructor(props) {
    super(props)
    this.container = 'header',
    this.state = 'World'
    this.componentShouldUpdate = false
  }
  render: (data) => {
    return (
      &lt;h1>Hello, {data ? `: ${data}`: ''}!&lt;/h1>
    )
  }
}
// Create instance of Hello:
const hello = new Hello()

// Some time later update the component's state:
hello.setState('Joe')
// Because componentShouldUpdate is false, the component will not update.

// Some time later set componentShouldUpdate to true:
hello.componentShouldUpdate = true
hello.setState('Joe')
// Now the component updates.
</code>
          </pre>
          <p>&nbsp;</p>
      </div>

      <aside>
        <menu>
          <ul class="docs__menu">
            <li class="docs__menu__item">
              <a href='./installation.html'>Installation</a>
            </li>
            <li class="docs__menu__item">
              <a href='./render.html'>Mount/Render</a>
            </li>
            <li class="docs__menu__item">
              <a href='./functional-components.html'>Functional Components</a>
            </li>
            <li class="docs__menu__item">
              <a href='./component-instance.html'>Component Instance</a>
            </li>
            <li class="docs__menu__item">
              <a href='./extending-component.html'>Extending Component</a>
            </li>
            <li class="docs__menu__item selected">
              <a href='./state.html'>State</a>
            </li>
            <li class="docs__menu__item">
              <a href='./jsx.html'>JSX</a>
            </li>
            <li class="docs__menu__item">
              <a href='./h.html'>H for Hyperscript</a>
            </li>
            <li class="docs__menu__item">
              <a href='./template-literals.html'>Template Literals</a>
            </li>
            <li class="docs__menu__item">
              <a href='./styles.html'>Styles</a>
            </li>
            <li class="docs__menu__item">
              <a href='./lifecycle-methods.html'>Lifecycle Methods</a>
            </li>
            <li class="docs__menu__item">
              <a href='./events.html'>Events</a>
            </li>
            <li class="docs__menu__item">
              <a href='./hydration.html'>Hydration</a>
            </li>
            <li class="docs__menu__item">
              <a href='./deployment.html'>Deployment</a>
            </li>
            <li class="docs__menu__item">
              <a href='./api.html'>API</a>
            </li>
            <li class="docs__menu__item">
              <a href='./about.html'>About</a>
            </li>
          </ul>
        </menu>
      </aside>
    </section> 
  </article>
  <footer>
      <section>
        <svg id='composi-logo-footer' viewBox="0 0 300 300" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
          <title>Composi Logo</title>
          <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
            <g id="Composi-Logo-Solid" fill="rgba(255,255,255,0.5)">
              <path d="M1.77635684e-15,0 L95,0 L95,38 L209,38 L209,0 L300,0 L300,94 L265,93.8571663 L265,209 L300,209 L300,300 L209,300 L209,265 L95,265 L95,300 L1.77635684e-15,300 L1.77635684e-15,209 L40,209 L40,94 L1.77635684e-15,93.8571663 L1.77635684e-15,0 Z M107,107 L107,192 L192,192 L192,107 L107,107 Z" id="Combined-Shape"></path>
            </g>
          </g>
        </svg>
        <h3>Composi is open source (MIT) and available on <a href='https://github.com/composor/composi' target='__blank'>Github</a> and <a href="https://www.npmjs.com/package/composi" target='__blank'>NPM</a>.</h3>
      </section>
    </footer>
  <script src="../js/prism.min.js"></script>
  <script src="../js/prism-jsx.js"></script>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-115293685-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'UA-115293685-1');
  </script>
</body>
</html>